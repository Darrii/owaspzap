# üåê Vulnerability Chain Detection - Web Interface

## Overview

The Web UI provides a user-friendly interface for analyzing OWASP ZAP reports and detecting vulnerability chains.

## Features

### üéØ Core Features

- **üì§ File Upload**: Drag & drop or browse to upload ZAP JSON reports
- **‚öôÔ∏è Configurable Analysis**:
  - Max chain length (2-10)
  - Minimum confidence threshold (0-1)
  - Risk level filtering
- **üìä Interactive Dashboard**: Real-time statistics and visualizations
- **üìà Results Display**:
  - Summary statistics
  - Top vulnerability chains
  - Risk scoring breakdown
- **üìÑ Report Generation**:
  - View HTML reports in browser
  - View JSON data
  - Download reports for offline viewing
- **üìö Rules Browser**: View all 15 chain detection rules
- **üïí History**: Browse and manage previous analyses

## Quick Start

### 1. Start the Server

```bash
# Default (http://0.0.0.0:8000)
python run_web_ui.py

# Custom port
python run_web_ui.py --port 8080

# Specific host
python run_web_ui.py --host 127.0.0.1 --port 9000
```

### 2. Access the Dashboard

Open your browser and navigate to:
```
http://localhost:8000/
```

### 3. Upload a ZAP Report

1. Click "Browse Files" or drag & drop a ZAP JSON report
2. Optionally adjust analysis parameters
3. File will be automatically uploaded and analyzed
4. View results in the dashboard

### 4. View Reports

- **HTML Report**: Click "View HTML Report" for detailed analysis
- **JSON Data**: Click "View JSON" for raw data
- **Download**: Download reports for offline viewing

## API Endpoints

The web interface exposes a RESTful API:

### Health Check
```
GET /api/health
```

### Upload Report
```
POST /api/upload
Content-Type: multipart/form-data

file: ZAP JSON report
```

### Analyze Report
```
POST /api/analyze/{analysis_id}?max_chain_length=5&min_confidence=0.6&min_risk_filter=Medium
```

### Get Results
```
GET /api/results/{analysis_id}
```

### View HTML Report
```
GET /api/report/{analysis_id}/html
```

### View JSON Report
```
GET /api/report/{analysis_id}/json
```

### Download Reports
```
GET /api/download/{analysis_id}/html
GET /api/download/{analysis_id}/json
```

### List Analyses
```
GET /api/analyses
```

### Delete Analysis
```
DELETE /api/analysis/{analysis_id}
```

### Get Chain Rules
```
GET /api/rules
```

## API Documentation

Interactive API documentation available at:

- **Swagger UI**: http://localhost:8000/docs
- **ReDoc**: http://localhost:8000/redoc

## Architecture

```
vulnerability_chains/web/
‚îú‚îÄ‚îÄ app.py              # FastAPI application
‚îú‚îÄ‚îÄ templates/          # HTML templates
‚îÇ   ‚îî‚îÄ‚îÄ index.html      # Main dashboard
‚îú‚îÄ‚îÄ static/             # Static assets
‚îÇ   ‚îú‚îÄ‚îÄ css/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ style.css   # Styles
‚îÇ   ‚îî‚îÄ‚îÄ js/
‚îÇ       ‚îî‚îÄ‚îÄ app.js      # JavaScript
‚îî‚îÄ‚îÄ uploads/            # Uploaded files (temp)
```

## Configuration

### Analysis Parameters

- **Max Chain Length** (default: 5): Maximum number of vulnerabilities in a chain
- **Min Confidence** (default: 0.6): Minimum confidence threshold (0.0-1.0)
- **Min Risk Filter**: Filter vulnerabilities by risk level (Low/Medium/High/Critical)

### Server Settings

Set via command-line arguments:

```bash
python run_web_ui.py --host 0.0.0.0 --port 8000
```

## Security Considerations

### Production Deployment

For production use, consider:

1. **Authentication**: Add authentication middleware
2. **HTTPS**: Use reverse proxy (nginx) with SSL/TLS
3. **File Size Limits**: Configure max upload size
4. **Rate Limiting**: Implement rate limiting for API endpoints
5. **Input Validation**: Validate all uploaded files
6. **CORS**: Configure CORS for production domains

### Example nginx Configuration

```nginx
server {
    listen 443 ssl;
    server_name your-domain.com;

    ssl_certificate /path/to/cert.pem;
    ssl_certificate_key /path/to/key.pem;

    location / {
        proxy_pass http://127.0.0.1:8000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }
}
```

## Development

### Running in Development Mode

```bash
# With auto-reload
uvicorn vulnerability_chains.web.app:app --reload --port 8000
```

### Adding New Features

1. **New API Endpoint**: Add to `app.py`
2. **UI Component**: Update `templates/index.html`
3. **Styling**: Modify `static/css/style.css`
4. **JavaScript**: Update `static/js/app.js`

## Troubleshooting

### Port Already in Use

```bash
# Check what's using the port
lsof -i :8000

# Use different port
python run_web_ui.py --port 8080
```

### File Upload Fails

- Check file is valid JSON
- Verify file size is reasonable (<50MB)
- Check disk space in uploads directory

### Analysis Fails

- Verify ZAP report format is correct
- Check logs for specific error messages
- Try with simpler analysis parameters

## Performance

### Recommendations

- For large reports (>1000 vulnerabilities), increase analysis timeout
- Consider caching results for frequently accessed reports
- Clean up old uploads periodically

### Resource Usage

- Memory: ~200MB + (report size √ó 3)
- CPU: Depends on number of vulnerabilities and chain length
- Disk: Temporary uploads + generated reports

## Browser Compatibility

Tested and supported on:
- Chrome/Edge (latest)
- Firefox (latest)
- Safari (latest)

## Mobile Support

The dashboard is responsive and works on mobile devices, though desktop is recommended for best experience.

## Examples

### Using cURL

```bash
# Upload file
curl -X POST -F "file=@zap_report.json" http://localhost:8000/api/upload

# Analyze
curl -X POST http://localhost:8000/api/analyze/20250101_120000_123456

# Get results
curl http://localhost:8000/api/results/20250101_120000_123456

# Download HTML
curl -O http://localhost:8000/api/download/20250101_120000_123456/html
```

### Using Python

```python
import requests

# Upload
with open('zap_report.json', 'rb') as f:
    response = requests.post('http://localhost:8000/api/upload', files={'file': f})
    analysis_id = response.json()['analysis_id']

# Analyze
response = requests.post(f'http://localhost:8000/api/analyze/{analysis_id}')
results = response.json()

print(f"Found {results['statistics']['total_chains']} chains")
```

## License

MIT License - See main project LICENSE

## Support

For issues or questions:
1. Check this README
2. Review API documentation at `/docs`
3. Check main project documentation
4. Open GitHub issue

---

**Built with ‚ù§Ô∏è by SIAAS Research Team**
