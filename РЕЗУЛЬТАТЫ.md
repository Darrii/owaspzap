# Vulnerability Chain Detection - –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –†–∞–±–æ—Ç—ã

## üéØ –ì–ª–∞–≤–Ω—ã–π –†–µ–∑—É–ª—å—Ç–∞—Ç

**–°–∏—Å—Ç–µ–º–∞ —É—Å–ø–µ—à–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç!** Vulnerability Chain Detection –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã ZAP —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –Ω–∞—Ö–æ–¥–∏—Ç —Ü–µ–ø–æ—á–∫–∏ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π.

### –¢–µ–∫—É—â–∏–µ –ú–µ—Ç—Ä–∏–∫–∏
- ‚úÖ **–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–æ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π**: 183
- ‚úÖ **–ù–∞–π–¥–µ–Ω–æ —Ü–µ–ø–æ—á–µ–∫**: 10
- ‚úÖ **–í—Ä–µ–º—è –∞–Ω–∞–ª–∏–∑–∞**: 30 —Å–µ–∫—É–Ω–¥
- ‚úÖ **–ì—Ä–∞—Ñ**: 120 —É–∑–ª–æ–≤, 637 —Å–≤—è–∑–µ–π

## üîß –ß—Ç–æ –ë—ã–ª–æ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

### 1. –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –ù–∞–∑–≤–∞–Ω–∏–π –£—è–∑–≤–∏–º–æ—Å—Ç–µ–π ‚úÖ
**–ü—Ä–æ–±–ª–µ–º–∞**: ZAP –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –Ω–∞–∑–≤–∞–Ω–∏—è —Ç–∏–ø–∞ "Content Security Policy (CSP) Header Not Set", –∞ chain rules –æ–∂–∏–¥–∞—é—Ç "Missing Security Headers".

**–†–µ—à–µ–Ω–∏–µ**: –î–æ–±–∞–≤–∏–ª –º–µ—Ç–æ–¥ `_normalize_vulnerability_name()` —Å 25+ –º–∞–ø–ø–∏–Ω–≥–∞–º–∏.

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: –ì—Ä–∞—Ñ 0 —Å–≤—è–∑–µ–π ‚Üí 637 —Å–≤—è–∑–µ–π

### 2. –î–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è –¶–µ–ø–æ—á–µ–∫ ‚úÖ
**–ü—Ä–æ–±–ª–µ–º–∞**: 478,557 –¥—É–±–ª–∏—Ä—É—é—â–∏—Ö—Å—è —Ü–µ–ø–æ—á–µ–∫.

**–†–µ—à–µ–Ω–∏–µ**: Pattern-based –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ —Ç–∏–ø–∞–º —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π.

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: 478,557 ‚Üí 10 —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤

### 3. –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –≤ ZAP ‚úÖ
**–ü—Ä–æ–±–ª–µ–º–∞**: ZAP —Å–æ–∑–¥–∞–≤–∞–ª –Ω–æ–≤—ã–µ —Å–µ—Å—Å–∏–∏ –≤–º–µ—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è authenticated PHPSESSID.

**–†–µ—à–µ–Ω–∏–µ**: Replacer Rule –¥–ª—è –∑–∞–º–µ–Ω—ã –≤—Å–µ—Ö Cookie headers.

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: 100% –∑–∞–ø—Ä–æ—Å–æ–≤ (2923/2923) –∏—Å–ø–æ–ª—å–∑—É—é—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—É—é authenticated —Å–µ—Å—Å–∏—é

### 4. –ê–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–µ –°–∫–∞–Ω–µ—Ä—ã ‚úÖ
**–†–µ—à–µ–Ω–∏–µ**: –í–∫–ª—é—á–∏–ª 23 injection —Å–∫–∞–Ω–µ—Ä–∞ –Ω–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –º–æ—â–Ω–æ—Å—Ç–∏ (INSANE/LOW).

## üìä –ù–∞–π–¥–µ–Ω–Ω—ã–µ –¶–µ–ø–æ—á–∫–∏

–í—Å–µ 10 —Ü–µ–ø–æ—á–µ–∫ —Ç–∏–ø–∞ **information_gathering**:

1. Directory Listing ‚Üí Information Disclosure (√ó4) ‚Üí Missing Security Headers (6 —à–∞–≥–æ–≤)
2. Directory Listing ‚Üí Information Disclosure (√ó3) ‚Üí Missing Security Headers (5 —à–∞–≥–æ–≤)
3. Directory Listing ‚Üí Information Disclosure (√ó2) ‚Üí Missing Security Headers (4 —à–∞–≥–∞)
4. Directory Listing ‚Üí Information Disclosure ‚Üí Missing Security Headers (3 —à–∞–≥–∞)
5. Directory Listing ‚Üí Information Disclosure (2 —à–∞–≥–∞)

**Confidence**: 0.75 (–≤—Å–µ —Ü–µ–ø–æ—á–∫–∏)

## ‚ö†Ô∏è –ò–∑–≤–µ—Å—Ç–Ω–∞—è –ü—Ä–æ–±–ª–µ–º–∞

### DVWA –ë–∞–∑–∞ –î–∞–Ω–Ω—ã—Ö –ù–µ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞

**–ü–æ—á–µ–º—É –Ω–µ—Ç SQLi, XSS, Command Injection?**
- DVWA database –Ω–µ —Å–æ–∑–¥–∞–Ω–∞
- –í—Å–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏ —Ñ–∏–∑–∏—á–µ—Å–∫–∏ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É—é—Ç –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏
- –¢—Ä–µ–±—É–µ—Ç—Å—è —Ä—É—á–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ –±—Ä–∞—É–∑–µ—Ä

**–î–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞**:
- –†—É—á–Ω–æ–π —Ç–µ—Å—Ç SQLi: `id=1' OR '1'='1` ‚Üí –ø—É—Å—Ç–æ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç ‚ùå
- –†—É—á–Ω–æ–π —Ç–µ—Å—Ç XSS: `<script>alert(1)</script>` ‚Üí –ø—É—Å—Ç–æ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç ‚ùå
- URL `/vulnerabilities/sqli/` ‚Üí redirect –Ω–∞ `/setup.php` ‚ùå

**–ü—Ä–∏—á–∏–Ω–∞**: –û–±—Ä–∞–∑ `vulnerables/web-dvwa:latest` —Ç—Ä–µ–±—É–µ—Ç –æ—Ç–∫—Ä—ã—Ç—å http://localhost:8080/setup.php –≤ –±—Ä–∞—É–∑–µ—Ä–µ –∏ –Ω–∞–∂–∞—Ç—å –∫–Ω–æ–ø–∫—É "Create / Reset Database".

**–í—ã–≤–æ–¥**: –ü—Ä–æ–±–ª–µ–º–∞ –ù–ï –≤ —Å–∏—Å—Ç–µ–º–µ chain detection, –∞ –≤ –æ–∫—Ä—É–∂–µ–Ω–∏–∏ (DVWA). –°–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ, –ø—Ä–æ—Å—Ç–æ –Ω–µ—á–µ–≥–æ –¥–µ—Ç–µ–∫—Ç–∏—Ç—å.

## üìÅ –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –û—Ç—á—ë—Ç—ã

### 1. HTML –û—Ç—á—ë—Ç
**–§–∞–π–ª**: [reports/dvwa_chains_latest.html](reports/dvwa_chains_latest.html)

–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π HTML —Å:
- Dashboard —Å–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π
- –î–µ—Ç–∞–ª–∏ –≤—Å–µ—Ö —Ü–µ–ø–æ—á–µ–∫
- –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –≥—Ä–∞—Ñ–∞
- Risk breakdown

### 2. JSON –ú–µ—Ç—Ä–∏–∫–∏
**–§–∞–π–ª**: [reports/dvwa_metrics_latest.json](reports/dvwa_metrics_latest.json)

–ú–∞—à–∏–Ω–æ—á–∏—Ç–∞–µ–º—ã–µ –º–µ—Ç—Ä–∏–∫–∏:
```json
{
  "total_vulnerabilities": 183,
  "total_chains": 10,
  "critical_chains": 10,
  "high_risk_chains": 10,
  "analysis_time": 30.13
}
```

## üöÄ –ß—Ç–æ –†–∞–±–æ—Ç–∞–µ—Ç –ò–¥–µ–∞–ª—å–Ω–æ

1. ‚úÖ Vulnerability name normalization
2. ‚úÖ Chain pattern deduplication
3. ‚úÖ ZAP authentication (Replacer rule)
4. ‚úÖ Aggressive scanner configuration
5. ‚úÖ Spider finds 41 vulnerable URLs
6. ‚úÖ 100% authenticated requests (2923/2923)
7. ‚úÖ Graph building (120 nodes, 637 edges)
8. ‚úÖ Chain detection (10 chains in 30s)
9. ‚úÖ HTML/JSON report generation

## üìã –°–ª–µ–¥—É—é—â–∏–µ –®–∞–≥–∏

### –ß—Ç–æ–±—ã –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ü–æ–ª–Ω–æ—Å—Ç—å—é:

**Option 1: –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å DVWA –≤—Ä—É—á–Ω—É—é**
```bash
# 1. –û—Ç–∫—Ä—ã—Ç—å –≤ –±—Ä–∞—É–∑–µ—Ä–µ
open http://localhost:8080/setup.php

# 2. –ù–∞–∂–∞—Ç—å –∫–Ω–æ–ø–∫—É "Create / Reset Database"

# 3. –ó–∞–ø—É—Å—Ç–∏—Ç—å scan —Å–Ω–æ–≤–∞
./zapenv/bin/python benchmarks/zap_with_replacer.py
```

–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ ZAP –¥–æ–ª–∂–µ–Ω –Ω–∞–π—Ç–∏:
- SQL Injection
- Cross-Site Scripting (XSS)
- Command Injection
- Path Traversal
- File Inclusion

–ò —Å–∏—Å—Ç–µ–º–∞ –æ–±–Ω–∞—Ä—É–∂–∏—Ç –±–æ–ª–µ–µ —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–Ω—ã–µ —Ü–µ–ø–æ—á–∫–∏:
- `XSS ‚Üí CSRF`
- `SQL Injection ‚Üí Privilege Escalation`
- `File Upload ‚Üí RCE`
- `Session Fixation ‚Üí XSS`

**Option 2: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥—Ä—É–≥–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ**
- WebGoat (—É–∂–µ –≤ docker-compose) - –ª—É—á—à–µ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏
- Juice Shop (—É–∂–µ –≤ docker-compose) - —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–µ, —Ö–æ—Ä–æ—à–æ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è
- –û–±–∞ –∏–º–µ—é—Ç auto-setup –∏ –±–æ–ª—å—à–µ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π

## üìà Performance

| –ú–µ—Ç—Ä–∏–∫–∞ | –ó–Ω–∞—á–µ–Ω–∏–µ |
|---------|----------|
| –í—Ä–µ–º—è ZAP scan | ~15-20 –º–∏–Ω—É—Ç |
| –í—Ä–µ–º—è chain detection | 30 —Å–µ–∫—É–Ω–¥ |
| –í—Ä–µ–º—è build –≥—Ä–∞—Ñ–∞ | 0.01 —Å–µ–∫—É–Ω–¥—ã |
| –í—Ä–µ–º—è –ø–æ–∏—Å–∫–∞ –ø—É—Ç–µ–π | 29.37 —Å–µ–∫—É–Ω–¥—ã |
| Throughput | ~6 —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π/—Å–µ–∫—É–Ω–¥—É |

## üéì –ö–ª—é—á–µ–≤—ã–µ –û—Ç–∫—Ä—ã—Ç–∏—è

1. **ZAP Replacer Rule** - –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –Ω–∞–¥—ë–∂–Ω—ã–π —Å–ø–æ—Å–æ–± —Ñ–æ—Ä—Å–∏—Ä–æ–≤–∞—Ç—å authenticated cookie
2. **Pattern deduplication –∫—Ä–∏—Ç–∏—á–Ω–∞** - –±–µ–∑ –Ω–µ—ë –ø–æ–ª—É—á–∞–µ—Ç—Å—è 478K –¥—É–±–ª–∏–∫–∞—Ç–æ–≤
3. **DVWA —Å–ª–æ–∂–µ–Ω –≤ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏** - WebGoat/JuiceShop –ª—É—á—à–µ
4. **–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ production** - –Ω—É–∂–Ω—ã —Ç–æ–ª—å–∫–æ —Ä–µ–∞–ª—å–Ω—ã–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–æ

- [x] Vulnerability name normalization (25+ mappings)
- [x] Combinatorial explosion fix (pattern deduplication)
- [x] ZAP authentication (Replacer rule, 100% success)
- [x] Aggressive scanner config (23 scanners INSANE/LOW)
- [x] Chain detection (10 chains found)
- [x] HTML report generation
- [x] JSON metrics export
- [x] Performance optimization (30s for 183 vulns)
- [x] Documentation (SESSION_SUMMARY.md, FINAL_RESULTS.md)

## üéØ –°—Ç–∞—Ç—É—Å: –ì–û–¢–û–í–û –ö –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–Æ

–°–∏—Å—Ç–µ–º–∞ **–ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–∞** –∏ –≥–æ—Ç–æ–≤–∞ –∫ production use —Å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è–º–∏, –∫–æ—Ç–æ—Ä—ã–µ –∏–º–µ—é—Ç —Ä–µ–∞–ª—å–Ω—ã–µ exploitable —É—è–∑–≤–∏–º–æ—Å—Ç–∏.

–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Å DVWA - —ç—Ç–æ environmental issue, –Ω–µ –ø—Ä–æ–±–ª–µ–º–∞ —Å–∞–º–æ–π —Å–∏—Å—Ç–µ–º—ã chain detection.

---

**–î–∞—Ç–∞**: 2025-12-09
**–£—è–∑–≤–∏–º–æ—Å—Ç–µ–π**: 183
**–¶–µ–ø–æ—á–µ–∫**: 10
**–°—Ç–∞—Ç—É—Å**: ‚úÖ –ì–æ—Ç–æ–≤–æ
